
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Pomodori Controller and Blogging from the coffee shop...</title>
    
    <meta name="author" content="Daniel Dosen">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/css/1.4.0/bootstrap.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->
  </head>

  <body>

    <div class="topbar">
      <div class="fill">
        <div class="container">
          <a class="brand" href="/">danieldosen.org</a>
          <ul class="nav">
            
            
            


  
    
    	
    	<li><a href="/archive.html">Archive</a></li>
    	
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container">

      <div class="content">
        
<div class="page-header">
  <h1>Pomodori Controller and Blogging from the coffee shop... </h1>
</div>

<div class="row">
  <div class="span10">
    <ul>
<li>in the coffee shop</li>

<li>not using their sucky bandwidth</li>

<li>using personal hotspot - &#8230;</li>

<li>profit</li>
</ul>
<div class='highlight'><pre><code class='ruby'>  <span class='k'>def</span> <span class='nf'>create</span>
    <span class='n'>respond_to</span> <span class='k'>do</span> <span class='o'>|</span><span class='nb'>format</span><span class='o'>|</span>
      <span class='nb'>format</span><span class='o'>.</span><span class='n'>json</span> <span class='p'>{</span>
        <span class='vi'>@activity</span> <span class='o'>=</span>  <span class='no'>Activity</span><span class='o'>.</span><span class='n'>find</span><span class='p'>(</span><span class='n'>params</span><span class='o'>[</span><span class='ss'>:activity_id</span><span class='o'>]</span><span class='p'>)</span>
        <span class='c1'># validate that this user is the current user...</span>
        <span class='vi'>@user</span> <span class='o'>=</span>  <span class='vi'>@activity</span><span class='o'>.</span><span class='n'>user</span>
        <span class='vi'>@pomodoro</span> <span class='o'>=</span> <span class='no'>Pomodoro</span><span class='o'>.</span><span class='n'>new</span><span class='p'>(</span><span class='n'>params</span><span class='o'>[</span><span class='ss'>:pomodoro</span><span class='o'>]</span><span class='p'>)</span>
        <span class='vi'>@pomodoro</span><span class='o'>.</span><span class='n'>activity</span> <span class='o'>=</span> <span class='vi'>@activity</span>

        <span class='n'>respond_to</span> <span class='k'>do</span> <span class='o'>|</span><span class='nb'>format</span><span class='o'>|</span>
          <span class='k'>if</span> <span class='vi'>@pomodoro</span><span class='o'>.</span><span class='n'>save</span>
            <span class='n'>render</span> <span class='n'>json</span><span class='p'>:</span> <span class='vi'>@activity</span><span class='p'>,</span> <span class='n'>status</span><span class='p'>:</span> <span class='ss'>:created</span><span class='p'>,</span> <span class='n'>location</span><span class='p'>:</span> <span class='vi'>@activity</span>
          <span class='k'>else</span>
            <span class='n'>render</span> <span class='n'>json</span><span class='p'>:</span> <span class='vi'>@activity</span><span class='o'>.</span><span class='n'>errors</span><span class='p'>,</span> <span class='n'>status</span><span class='p'>:</span> <span class='ss'>:unprocessable_entity</span>
          <span class='k'>end</span>
        <span class='k'>end</span>

      <span class='p'>}</span>
    <span class='k'>end</span>
  <span class='k'>end</span>
</code></pre>
</div>
<p>Updating a new controller in pomodoro service that works on existing activities. No reason to nest this under the user, as the user can be gotten from the activity. That means that you need to verify the current user is the user making the json call.</p>
    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/2011/07/25/concentration-and-simplynoise-com" title="Concentration and simplynoise.com">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next"><a href="/2011/07/25/posting-an-image-from-marsedit-to-a-wordpress-blog" title="Posting an image from MarsEdit to a wordpress blog..">Next &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'danieldosen'; // required: replace example with your forum shortname
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
  
  <div class="span4">
    <h4>Published</h4>
    <div class="date"><span>25 July 2011</span></div>

  
    <h4>Tags</h4>
    <ul class="tag_box">
    
    


  
     
    	<li><a href="/tags.html#Personal-ref">Personal <span>3</span></a></li>
    
  



    </ul>
    
  </div>
</div>


      </div>

      <footer>
        <p>&copy; Daniel Dosen 2012 
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div> <!-- /container -->

    
  </body>
</html>

